---
title: "MDA 9159 - Statistical Modelling 1 - Fall 2024"
author: "Group - Team Bits: Zhangju Xi, Pengwei Xu, Lingyu Zhao"
output:
  pdf_document: default
  word_document: default
  html_document: default
urlcolor: blue
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
```

```{r, include = FALSE}
library(knitr)
#opts_chunk$set(tidy.opts=list(width.cutoff=70),tidy=TRUE)
```

\newpage

# Loading Date and Data Exploratory Analysis

```{r}
library(dplyr)

# Read in dataset from github
data = read.csv("https://raw.githubusercontent.com/Panta-Rhei-LZ/MDA_9159_Team_Bits_Project/refs/heads/main/Team_Bits_Data.csv")

# Remove price=0 entries
data = data[data$PRICE != 0, ]

# Remove rows with NA in all columns except 'YR_RMDL'
data = data %>% filter(!if_any(-YR_RMDL, is.na))

# Remove not useful columns
data = data %>% select(-SSL, -OBJECTID, -GIS_LAST_MOD_DTTM, 
                       -QUALIFIED, -SALE_NUM, -BLDG_NUM,
                       -STYLE_D, -STRUCT_D, -GRADE_D,
                       -CNDTN_D, -EXTWALL_D, -ROOF_D,
                       -INTWALL_D, -USECODE, -HEAT_D,
                       -NUM_UNITS, -STRUCT)

head(data)
```

### Variable Explanation

We are dealing with housing data in this report, let me go over through the meanings behind each predictor:

  1. PRICE: response
  2. BATHRM: # bathrooms
  3. HF_BATHRM: # half bathrooms
  4. HEAT: heating
  5. AC: air conditioning
  6. ROOMS: # rooms
  7. BEDRM: # bedrooms
  8. AYB: The earliest time the main portion of the building was built
  9. YR_RMDL: Year structure was remodelled
  10. EYB: The year an improvement was built 
  11. STORIES: # stories in primary dwelling
  12. SALEDATE: Date of sale
  13. GBA: Gross building area in square feet
  14. STYLE: House style
  15. GRADE: House grade
  16. CNDTN: House condition
  17. EXTWALL: Exterior wall tyle
  18. ROOF: Roof type
  19. INTWALL: Interior wall type
  20. KITCHENS: # kitchens
  21. FIREPLACES: # fireplaces
  22. LANDAREA: Land area of property in square feet


### NA Data

Now let us explore the percentage of missing data for each predictor:

```{r}
missing_data = round(sapply(data, function(x) mean(is.na(x) * 100)), 3)

missing_data
```

From the R output above, observe that "YR_RMDL: Year structure was remodeled" has around 36% missing data. A possible explanation for this could be: not all buildings were remodeled.


### Preprocessing

* Converted categorical variables to numerical values:

  1) AC: "Y" and "N" corresponds to "1" and "0".
  
  2) SALEDATE: Transform calendar format values in SALEDATE to numerical values using as.Date().
  
* Introduced a few new variables:

  1) `SALE_YEAR`: The year that the house was sold, it is derived from `SALEDATE`.
  
  2) `SALE_AYB_DIFF`: The difference between the year sold and the year built.
  
  3) `SALE_EYB_DIFF`: The difference between the year sold and the year an improvement was applied.

  4) `SALE_RMDL_DIFF`: The difference between the year sold and the year structure was remodeled.'
  

```{r}
library(lubridate)

# Transform Yes/No for having AC to numerical values
data$AC = ifelse(data$AC == 'Y', 1, 0)

# Add SALEYEAR
data$SALE_YEAR = year(ymd_hms(data$SALEDATE))

# Add SALEYEAR and AYB diff
data$SALE_AYB_DIFF = data$SALE_YEAR - data$AYB

# Add SALEYEAR and EYB diff
data$SALE_EYB_DIFF = data$SALE_YEAR - data$EYB

# Add SALEYEAR and YR_RMDL diff
data$SALE_RMDL_DIFF = data$SALE_YEAR - data$YR_RMDL

# Convert SALEDATE column to numeric values
data$SALEDATE = as.numeric(as.Date(data$SALEDATE))
```

<<<<<<< HEAD

### Data for Training and Validating

```{r}
set.seed(9159)
clean_data = data[sample(nrow(data), 600),]
```

=======
```{r}
#asd
```
>>>>>>> dc0589016709044b527c885be3ed0e8fc58f93e6

